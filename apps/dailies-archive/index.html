<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Dailies | Industry Intelligence</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EðŸŽ¬%3C/text%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --void: #08080c;
      --deep: #0f0f14;
      --surface: #16161d;
      --elevated: #1e1e28;
      --border: #2a2a38;
      --muted: #6a6a7a;
      --text: #c8c8d0;
      --bright: #e8e8ec;
      --gold: #d4a855;
      --gold-dim: #a88a44;
      --gold-glow: #e8c06830;
      --cyan: #4ac8c8;
      --cyan-dim: #3a9a9a;
      --burgundy: #a83848;
      --burgundy-dim: #7a2832;
      --stone-base: #4a4540;
      --stone-light: #8a8070;
      --stone-dark: #2a2520;
      --stone-highlight: #b8a890;
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 16px;
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.3);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
      --shadow-lg: 0 8px 32px rgba(0,0,0,0.5);
      --transition-fast: 0.15s ease;
      --transition-med: 0.3s ease;
      --transition-slow: 0.5s ease;
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Cormorant Garamond', Georgia, serif;
      background: var(--void);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Noise texture overlay */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 9999;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--void); }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--muted); }

    /* Selection */
    ::selection {
      background: var(--gold);
      color: var(--void);
    }

    /* ========== APP LAYOUT ========== */
    .app {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* ========== HEADER ========== */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: linear-gradient(to bottom, var(--void) 0%, var(--void) 70%, transparent 100%);
      padding: 1.5rem 2rem 2.5rem;
    }

    .header-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 2rem;
    }

    /* BEN-HUR 3D Stone Title */
    .logo {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      text-decoration: none;
      cursor: pointer;
    }

    .logo-prefix {
      font-family: 'Cinzel', serif;
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 0.4em;
      color: var(--gold-dim);
      text-transform: uppercase;
      margin-bottom: 0.25rem;
      margin-left: 0.25rem;
    }

    .logo-main {
      font-family: 'Cinzel', serif;
      font-weight: 900;
      font-size: clamp(1.8rem, 4vw, 2.8rem);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      line-height: 1;
      position: relative;
      /* 3D Stone effect */
      color: var(--stone-light);
      text-shadow:
        /* Top light edge */
        0 -1px 0 var(--stone-highlight),
        1px -1px 0 var(--stone-highlight),
        /* Right edge shadow */
        1px 0 0 var(--stone-base),
        2px 1px 0 var(--stone-dark),
        3px 2px 0 var(--stone-dark),
        4px 3px 0 rgba(0,0,0,0.4),
        5px 4px 0 rgba(0,0,0,0.3),
        6px 5px 0 rgba(0,0,0,0.2),
        /* Bottom shadow */
        0 1px 0 var(--stone-base),
        1px 2px 0 var(--stone-dark),
        /* Depth shadow */
        4px 6px 8px rgba(0,0,0,0.5),
        6px 8px 16px rgba(0,0,0,0.4);
      /* Inner texture effect */
      background: linear-gradient(
        145deg,
        var(--stone-highlight) 0%,
        var(--stone-light) 20%,
        var(--stone-base) 50%,
        var(--stone-light) 80%,
        var(--stone-highlight) 100%
      );
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: drop-shadow(2px 3px 2px rgba(0,0,0,0.5));
      transition: var(--transition-med);
    }

    .logo:hover .logo-main {
      filter: drop-shadow(3px 4px 3px rgba(0,0,0,0.6)) brightness(1.1);
      transform: translateY(-1px);
    }

    .logo-accent {
      display: inline-block;
      color: var(--gold);
      background: linear-gradient(
        145deg,
        #e8c068 0%,
        var(--gold) 30%,
        #c49845 60%,
        var(--gold) 100%
      );
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: none;
      filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));
    }

    /* Navigation */
    .nav {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .nav-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: transparent;
      border: 1px solid transparent;
      border-radius: var(--radius-md);
      color: var(--muted);
      font-family: 'Cinzel', serif;
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .nav-btn:hover {
      color: var(--bright);
      background: var(--elevated);
      border-color: var(--border);
    }

    .nav-btn.active {
      color: var(--gold);
      background: var(--surface);
      border-color: var(--gold-dim);
    }

    .nav-btn svg {
      width: 16px;
      height: 16px;
      opacity: 0.8;
    }

    .nav-btn .badge {
      background: var(--burgundy);
      color: var(--bright);
      font-size: 0.65rem;
      padding: 0.1rem 0.4rem;
      border-radius: 10px;
      margin-left: 0.25rem;
    }

    /* ========== SEARCH BAR ========== */
    .search-container {
      max-width: 1400px;
      margin: 0 auto 2rem;
      padding: 0 2rem;
    }

    .search-bar {
      display: flex;
      align-items: center;
      gap: 1rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 0.75rem 1.25rem;
      transition: var(--transition-fast);
    }

    .search-bar:focus-within {
      border-color: var(--gold-dim);
      box-shadow: 0 0 0 3px var(--gold-glow);
    }

    .search-bar svg {
      width: 20px;
      height: 20px;
      color: var(--muted);
      flex-shrink: 0;
    }

    .search-input {
      flex: 1;
      background: none;
      border: none;
      outline: none;
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      color: var(--bright);
    }

    .search-input::placeholder {
      color: var(--muted);
    }

    .search-shortcut {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      color: var(--muted);
      padding: 0.25rem 0.5rem;
      background: var(--elevated);
      border-radius: var(--radius-sm);
    }

    /* ========== MAIN CONTENT ========== */
    .main {
      flex: 1;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem 4rem;
      width: 100%;
    }

    /* View Tabs */
    .view-tabs {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .view-tab {
      padding: 0.5rem 1rem;
      background: transparent;
      border: none;
      border-radius: var(--radius-md);
      color: var(--muted);
      font-family: 'Cinzel', serif;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .view-tab:hover {
      color: var(--text);
      background: var(--elevated);
    }

    .view-tab.active {
      color: var(--gold);
      background: var(--surface);
    }

    /* Section Header */
    .section-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }

    .section-title {
      font-family: 'Cinzel', serif;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--bright);
    }

    .section-count {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--muted);
    }

    /* ========== STORY CARDS ========== */
    .stories-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 1.5rem;
    }

    .story-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      cursor: pointer;
      transition: var(--transition-med);
      position: relative;
      overflow: hidden;
    }

    .story-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--gold-dim), var(--gold), var(--gold-dim));
      transform: scaleX(0);
      transform-origin: left;
      transition: transform var(--transition-med);
    }

    .story-card:hover {
      border-color: var(--gold-dim);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .story-card:hover::before {
      transform: scaleX(1);
    }

    .story-card.bookmarked {
      border-color: var(--cyan-dim);
    }

    .story-card.bookmarked::before {
      background: linear-gradient(90deg, var(--cyan-dim), var(--cyan), var(--cyan-dim));
      transform: scaleX(1);
    }

    .story-meta {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 0.75rem;
    }

    .story-section {
      font-family: 'Cinzel', serif;
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--gold);
      padding: 0.2rem 0.6rem;
      background: var(--gold-glow);
      border-radius: var(--radius-sm);
    }

    .story-date {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      color: var(--muted);
    }

    .story-headline {
      font-family: 'Cinzel', serif;
      font-size: 1.1rem;
      font-weight: 600;
      line-height: 1.4;
      color: var(--bright);
      margin-bottom: 0.75rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .story-preview {
      font-size: 0.95rem;
      color: var(--text);
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .story-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .story-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .tag {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem;
      padding: 0.2rem 0.5rem;
      background: var(--elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--muted);
      transition: var(--transition-fast);
    }

    .tag:hover {
      color: var(--cyan);
      border-color: var(--cyan-dim);
    }

    .story-actions {
      display: flex;
      gap: 0.25rem;
      opacity: 0;
      transition: var(--transition-fast);
    }

    .story-card:hover .story-actions {
      opacity: 1;
    }

    .action-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background: var(--elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--muted);
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .action-btn:hover {
      color: var(--bright);
      border-color: var(--muted);
    }

    .action-btn.active {
      color: var(--cyan);
      border-color: var(--cyan-dim);
      background: rgba(74, 200, 200, 0.1);
    }

    .action-btn svg {
      width: 14px;
      height: 14px;
    }

    /* ========== TOPICS GRID ========== */
    .topics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 1rem;
    }

    .topic-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 1.25rem;
      cursor: pointer;
      transition: var(--transition-fast);
      text-align: center;
    }

    .topic-card:hover {
      border-color: var(--gold-dim);
      background: var(--elevated);
    }

    .topic-name {
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--bright);
      margin-bottom: 0.5rem;
    }

    .topic-count {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      color: var(--gold-dim);
    }

    /* ========== INSIGHTS PANEL ========== */
    .insights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .insight-card {
      background: linear-gradient(145deg, var(--surface) 0%, var(--elevated) 100%);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
    }

    .insight-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .insight-icon {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--gold-glow);
      border-radius: var(--radius-md);
      color: var(--gold);
    }

    .insight-icon svg {
      width: 20px;
      height: 20px;
    }

    .insight-title {
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      color: var(--bright);
    }

    .insight-value {
      font-family: 'Cinzel', serif;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--gold);
      line-height: 1;
      margin-bottom: 0.5rem;
    }

    .insight-label {
      font-size: 0.9rem;
      color: var(--muted);
    }

    .insight-list {
      list-style: none;
    }

    .insight-list li {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border);
      font-size: 0.9rem;
    }

    .insight-list li:last-child {
      border-bottom: none;
    }

    .insight-list .topic {
      color: var(--bright);
    }

    .insight-list .count {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--gold-dim);
    }

    /* ========== STORY MODAL ========== */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(8, 8, 12, 0.9);
      backdrop-filter: blur(8px);
      z-index: 1000;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 2rem;
      overflow-y: auto;
      opacity: 0;
      pointer-events: none;
      transition: var(--transition-med);
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: auto;
    }

    .modal {
      width: 100%;
      max-width: 800px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      margin: 2rem 0;
      transform: translateY(20px) scale(0.98);
      transition: var(--transition-med);
    }

    .modal-overlay.open .modal {
      transform: translateY(0) scale(1);
    }

    .modal-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      padding: 1.5rem 1.5rem 0;
    }

    .modal-close {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--muted);
      cursor: pointer;
      transition: var(--transition-fast);
      flex-shrink: 0;
    }

    .modal-close:hover {
      color: var(--bright);
      border-color: var(--muted);
    }

    .modal-meta {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .modal-content {
      padding: 1.5rem;
    }

    .modal-headline {
      font-family: 'Cinzel', serif;
      font-size: 1.8rem;
      font-weight: 700;
      line-height: 1.3;
      color: var(--bright);
      margin-bottom: 1.5rem;
    }

    .modal-body {
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text);
    }

    .modal-body p {
      margin-bottom: 1.25rem;
    }

    .modal-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border);
    }

    .modal-actions {
      display: flex;
      gap: 0.75rem;
      padding: 1.5rem;
      border-top: 1px solid var(--border);
      background: var(--elevated);
      border-radius: 0 0 var(--radius-lg) var(--radius-lg);
    }

    .modal-action-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      color: var(--text);
      font-family: 'Cinzel', serif;
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .modal-action-btn:hover {
      border-color: var(--muted);
      color: var(--bright);
    }

    .modal-action-btn.active {
      border-color: var(--cyan-dim);
      color: var(--cyan);
      background: rgba(74, 200, 200, 0.1);
    }

    .modal-action-btn svg {
      width: 14px;
      height: 14px;
    }

    /* ========== NOTES PANEL ========== */
    .notes-section {
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border);
    }

    .notes-title {
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--muted);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .notes-title svg {
      width: 14px;
      height: 14px;
    }

    .notes-input {
      width: 100%;
      min-height: 100px;
      background: var(--elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 1rem;
      font-family: 'Cormorant Garamond', serif;
      font-size: 1rem;
      color: var(--text);
      resize: vertical;
      outline: none;
      transition: var(--transition-fast);
    }

    .notes-input:focus {
      border-color: var(--gold-dim);
    }

    .notes-input::placeholder {
      color: var(--muted);
    }

    /* ========== EMPTY STATE ========== */
    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
    }

    .empty-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 50%;
      color: var(--muted);
    }

    .empty-icon svg {
      width: 36px;
      height: 36px;
    }

    .empty-title {
      font-family: 'Cinzel', serif;
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--bright);
      margin-bottom: 0.5rem;
    }

    .empty-text {
      color: var(--muted);
      max-width: 400px;
      margin: 0 auto;
    }

    /* ========== KEYBOARD SHORTCUTS MODAL ========== */
    .shortcuts-content {
      padding: 1.5rem;
    }

    .shortcut-group {
      margin-bottom: 1.5rem;
    }

    .shortcut-group:last-child {
      margin-bottom: 0;
    }

    .shortcut-group-title {
      font-family: 'Cinzel', serif;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--gold);
      margin-bottom: 0.75rem;
      text-transform: uppercase;
    }

    .shortcut-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.5rem 0;
    }

    .shortcut-label {
      color: var(--text);
      font-size: 0.95rem;
    }

    .shortcut-keys {
      display: flex;
      gap: 0.25rem;
    }

    .key {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      padding: 0.25rem 0.5rem;
      background: var(--elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--muted);
    }

    /* ========== TOAST NOTIFICATION ========== */
    .toast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--surface);
      border: 1px solid var(--gold-dim);
      border-radius: var(--radius-md);
      padding: 0.75rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      box-shadow: var(--shadow-lg);
      z-index: 1100;
      opacity: 0;
      transition: var(--transition-med);
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .toast-icon {
      color: var(--gold);
    }

    .toast-icon svg {
      width: 18px;
      height: 18px;
    }

    .toast-message {
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      color: var(--bright);
    }

    /* ========== BACK LINK ========== */
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--muted);
      text-decoration: none;
      font-family: 'Cinzel', serif;
      font-size: 0.8rem;
      letter-spacing: 0.05em;
      margin-bottom: 2rem;
      transition: var(--transition-fast);
    }

    .back-link:hover {
      color: var(--gold);
    }

    .back-link svg {
      width: 16px;
      height: 16px;
    }

    /* ========== FOOTER ========== */
    .footer {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
      border-top: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .footer-text {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .footer-link {
      color: var(--gold-dim);
      text-decoration: none;
      transition: var(--transition-fast);
    }

    .footer-link:hover {
      color: var(--gold);
    }

    .footer-shortcuts {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--muted);
      font-size: 0.8rem;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .footer-shortcuts:hover {
      color: var(--text);
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 768px) {
      .header {
        padding: 1rem 1rem 1.5rem;
      }

      .header-inner {
        flex-direction: column;
        align-items: flex-start;
      }

      .nav {
        width: 100%;
        overflow-x: auto;
        padding-bottom: 0.5rem;
      }

      .search-container {
        padding: 0 1rem;
      }

      .search-shortcut {
        display: none;
      }

      .main {
        padding: 0 1rem 2rem;
      }

      .stories-grid {
        grid-template-columns: 1fr;
      }

      .story-actions {
        opacity: 1;
      }

      .modal {
        margin: 1rem 0;
        border-radius: var(--radius-md);
      }

      .modal-headline {
        font-size: 1.4rem;
      }

      .footer {
        flex-direction: column;
        text-align: center;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* ========== ANIMATIONS ========== */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-in {
      animation: fadeIn 0.4s ease forwards;
    }

    .animate-delay-1 { animation-delay: 0.05s; opacity: 0; }
    .animate-delay-2 { animation-delay: 0.1s; opacity: 0; }
    .animate-delay-3 { animation-delay: 0.15s; opacity: 0; }
    .animate-delay-4 { animation-delay: 0.2s; opacity: 0; }
  </style>
</head>
<body>
  <div class="app" id="app">
    <!-- Header -->
    <header class="header">
      <div class="header-inner">
        <a class="logo" onclick="navigateTo('home')">
          <span class="logo-prefix">Industry Intelligence</span>
          <span class="logo-main">THE <span class="logo-accent">DAILIES</span></span>
        </a>
        <nav class="nav">
          <button class="nav-btn active" data-view="stories" onclick="setView('stories')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
            Stories
          </button>
          <button class="nav-btn" data-view="topics" onclick="setView('topics')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
            Topics
          </button>
          <button class="nav-btn" data-view="bookmarks" onclick="setView('bookmarks')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>
            Reading List
            <span class="badge" id="bookmark-count">0</span>
          </button>
          <button class="nav-btn" data-view="insights" onclick="setView('insights')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
            Insights
          </button>
        </nav>
      </div>
    </header>

    <!-- Search -->
    <div class="search-container">
      <div class="search-bar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" class="search-input" id="search-input" placeholder="Search stories, topics, companies..." autocomplete="off">
        <span class="search-shortcut"><span class="key">âŒ˜</span><span class="key">K</span></span>
      </div>
    </div>

    <!-- Main Content -->
    <main class="main" id="main-content">
      <!-- Content dynamically rendered here -->
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-text">
        Curated from <a href="https://www.thedailies.email/" target="_blank" class="footer-link">The Dailies Newsletter</a> â€¢ <a href="/apps/" class="footer-link">Back to Apps</a>
      </div>
      <div class="footer-shortcuts" onclick="showShortcuts()">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M6 8h.001M10 8h.001M14 8h.001M18 8h.001M8 12h8M6 16h.001M10 16h.001M14 16h.001M18 16h.001"/></svg>
        Keyboard Shortcuts
      </div>
    </footer>
  </div>

  <!-- Story Modal -->
  <div class="modal-overlay" id="story-modal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-meta">
          <span class="story-section" id="modal-section"></span>
          <span class="story-date" id="modal-date"></span>
        </div>
        <button class="modal-close" onclick="closeModal()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-content">
        <h1 class="modal-headline" id="modal-headline"></h1>
        <div class="modal-body" id="modal-body"></div>
        <div class="modal-tags" id="modal-tags"></div>
        <div class="notes-section">
          <h4 class="notes-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
            Your Notes
          </h4>
          <textarea class="notes-input" id="modal-notes" placeholder="Add your notes about this story..."></textarea>
        </div>
      </div>
      <div class="modal-actions">
        <button class="modal-action-btn" id="bookmark-btn" onclick="toggleBookmark()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>
          <span id="bookmark-text">Add to Reading List</span>
        </button>
        <button class="modal-action-btn" onclick="copyLink()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
          Copy Link
        </button>
      </div>
    </div>
  </div>

  <!-- Shortcuts Modal -->
  <div class="modal-overlay" id="shortcuts-modal">
    <div class="modal" style="max-width: 500px;">
      <div class="modal-header">
        <div class="modal-meta">
          <span class="story-section">Quick Reference</span>
        </div>
        <button class="modal-close" onclick="closeShortcuts()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="shortcuts-content">
        <div class="shortcut-group">
          <h4 class="shortcut-group-title">Navigation</h4>
          <div class="shortcut-row"><span class="shortcut-label">Focus search</span><div class="shortcut-keys"><span class="key">âŒ˜</span><span class="key">K</span></div></div>
          <div class="shortcut-row"><span class="shortcut-label">Go to Stories</span><div class="shortcut-keys"><span class="key">1</span></div></div>
          <div class="shortcut-row"><span class="shortcut-label">Go to Topics</span><div class="shortcut-keys"><span class="key">2</span></div></div>
          <div class="shortcut-row"><span class="shortcut-label">Go to Reading List</span><div class="shortcut-keys"><span class="key">3</span></div></div>
          <div class="shortcut-row"><span class="shortcut-label">Go to Insights</span><div class="shortcut-keys"><span class="key">4</span></div></div>
        </div>
        <div class="shortcut-group">
          <h4 class="shortcut-group-title">Actions</h4>
          <div class="shortcut-row"><span class="shortcut-label">Close modal</span><div class="shortcut-keys"><span class="key">Esc</span></div></div>
          <div class="shortcut-row"><span class="shortcut-label">Toggle bookmark</span><div class="shortcut-keys"><span class="key">B</span></div></div>
          <div class="shortcut-row"><span class="shortcut-label">Show shortcuts</span><div class="shortcut-keys"><span class="key">?</span></div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <span class="toast-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
    </span>
    <span class="toast-message" id="toast-message"></span>
  </div>

  <script>
    // ========== DATA STORE ==========
    const STORAGE_KEY = 'dailies_app_data';
    
    // Sample data - replace with your actual content
    const sampleStories = [
      {
        id: '1',
        section: 'Box Office',
        headline: 'Theatrical Windows Continue Shrinking as Studios Adapt',
        body: 'The traditional 90-day theatrical window is becoming a relic of the past. Major studios are now experimenting with windows as short as 17 days for certain releases, fundamentally reshaping the relationship between theatrical exhibition and streaming platforms.\n\nThis shift has accelerated following pandemic-era experiments that proved audiences would pay premium prices for day-and-date releases. Theater chains, initially resistant, have begun accepting shorter exclusivity periods in exchange for revenue-sharing arrangements that give them a stake in streaming success.\n\nThe implications for independent theaters remain concerning, as smaller venues lack the negotiating power of major chains.',
        date: '2024-12-15',
        topics: ['Box Office', 'Streaming', 'Theatrical'],
        entities: ['Netflix', 'AMC', 'Warner Bros']
      },
      {
        id: '2',
        section: 'Streaming',
        headline: 'Password Sharing Crackdown Delivers Unexpected Subscriber Surge',
        body: 'What was feared to be a subscriber exodus has instead become a growth catalyst. The industry-wide crackdown on password sharing, initially met with consumer backlash, has resulted in a net positive for major streaming services.\n\nNew data reveals that approximately 30% of former password sharers converted to paid subscriptions rather than canceling entirely. The remaining 70% split between those who added paid sharing features and those who churnedâ€”but churn rates have proven lower than projected.\n\nThis success has emboldened other platforms to implement similar measures, suggesting password sharing crackdowns will become standard practice across the industry.',
        date: '2024-12-14',
        topics: ['Streaming', 'Subscriber Growth'],
        entities: ['Netflix', 'Disney+', 'Max']
      },
      {
        id: '3',
        section: 'Labor',
        headline: 'AI Clause Negotiations Signal New Era for Creative Contracts',
        body: 'Following last year\'s historic strikes, AI protection clauses have become standard in entertainment contracts. However, the specifics vary wildly, creating a patchwork of protections that lawyers say will inevitably lead to disputes.\n\nSome contracts require explicit consent for AI training on creative work, while others simply guarantee human final approval on AI-assisted content. The lack of industry standardization means each negotiation requires careful attention to AI-specific language.\n\nAgencies report spending significantly more time on AI provisions than traditional compensation terms, reflecting the industry\'s recognition that these clauses may prove more valuable than immediate financial considerations.',
        date: '2024-12-13',
        topics: ['Labor', 'AI', 'Contracts'],
        entities: ['SAG-AFTRA', 'WGA', 'DGA']
      },
      {
        id: '4',
        section: 'International',
        headline: 'South Korean Content Pipeline Shows No Signs of Slowing',
        body: 'Korean content continues its global dominance, with streaming platforms reporting that Korean-language originals consistently outperform local productions in most markets. The phenomenon extends beyond the "Squid Game" effect, suggesting sustained structural advantages.\n\nProduction infrastructure in South Korea has expanded dramatically, with new studio complexes rivaling anything in Hollywood. Local crews have developed expertise in high-budget international productions, while maintaining cost advantages that make Korean shoots attractive to global streamers.\n\nThe talent pipeline appears equally robust, with Korean film schools reporting record applications and entertainment companies investing heavily in training programs.',
        date: '2024-12-12',
        topics: ['International', 'Streaming', 'Production'],
        entities: ['Netflix', 'CJ ENM', 'HYBE']
      },
      {
        id: '5',
        section: 'Technology',
        headline: 'Virtual Production Reaches Inflection Point',
        body: 'Virtual productionâ€”the LED wall technology that powered "The Mandalorian"â€”has moved beyond novelty to necessity for certain production types. Studios report that for anything involving complex environments or extensive visual effects, virtual production now offers clear advantages.\n\nThe technology has also democratized somewhat, with mid-budget productions accessing smaller LED volumes that would have been cost-prohibitive three years ago. However, expertise remains concentrated among a relatively small group of technicians, creating bottlenecks.\n\nThe next frontier appears to be real-time ray tracing and AI-powered scene generation, which could further reduce the gap between practical and virtual production quality.',
        date: '2024-12-11',
        topics: ['Technology', 'Production', 'Visual Effects'],
        entities: ['ILM', 'Lucasfilm', 'Epic Games']
      },
      {
        id: '6',
        section: 'Business',
        headline: 'Media M&A Activity Signals Consolidation Wave Incoming',
        body: 'After a quiet period following major mergers, deal activity is picking up across the entertainment sector. Analysts point to stabilizing interest rates and clearer streaming economics as catalysts for renewed consolidation.\n\nMid-size content companies appear particularly vulnerable, lacking both the scale of major studios and the agility of boutique producers. Several are reportedly in active discussions with potential acquirers or considering strategic alternatives.\n\nThe regulatory environment remains uncertain, but recent approvals suggest appetite for blocking deals has diminished, particularly when parties can demonstrate consumer benefits from integration.',
        date: '2024-12-10',
        topics: ['Business', 'M&A', 'Strategy'],
        entities: ['Paramount', 'Lionsgate', 'AMC Networks']
      }
    ];

    // State
    let state = {
      currentView: 'stories',
      searchQuery: '',
      selectedStory: null,
      bookmarks: [],
      notes: {},
      stories: sampleStories
    };

    // Load saved state
    function loadState() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          const parsed = JSON.parse(saved);
          state.bookmarks = parsed.bookmarks || [];
          state.notes = parsed.notes || {};
        }
      } catch (e) {
        console.error('Error loading state:', e);
      }
      updateBookmarkCount();
    }

    // Save state
    function saveState() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify({
          bookmarks: state.bookmarks,
          notes: state.notes
        }));
      } catch (e) {
        console.error('Error saving state:', e);
      }
    }

    // ========== NAVIGATION ==========
    function setView(view) {
      state.currentView = view;
      state.searchQuery = '';
      document.getElementById('search-input').value = '';
      
      // Update nav buttons
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.view === view);
      });
      
      render();
    }

    function navigateTo(page) {
      if (page === 'home') {
        setView('stories');
      }
    }

    // ========== RENDERING ==========
    function render() {
      const main = document.getElementById('main-content');
      
      switch (state.currentView) {
        case 'stories':
          main.innerHTML = renderStoriesView();
          break;
        case 'topics':
          main.innerHTML = renderTopicsView();
          break;
        case 'bookmarks':
          main.innerHTML = renderBookmarksView();
          break;
        case 'insights':
          main.innerHTML = renderInsightsView();
          break;
        default:
          main.innerHTML = renderStoriesView();
      }
    }

    function renderStoriesView() {
      const filtered = filterStories(state.stories);
      
      if (filtered.length === 0 && state.searchQuery) {
        return `
          <div class="empty-state">
            <div class="empty-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </div>
            <h3 class="empty-title">No stories found</h3>
            <p class="empty-text">Try different keywords or browse by topic.</p>
          </div>
        `;
      }
      
      return `
        <div class="view-tabs">
          <button class="view-tab active">All Stories</button>
          <button class="view-tab" onclick="filterByRecent()">This Week</button>
        </div>
        <div class="section-header">
          <h2 class="section-title">${state.searchQuery ? 'Search Results' : 'Latest Stories'}</h2>
          <span class="section-count">${filtered.length} ${filtered.length === 1 ? 'story' : 'stories'}</span>
        </div>
        <div class="stories-grid">
          ${filtered.map((story, i) => renderStoryCard(story, i)).join('')}
        </div>
      `;
    }

    function renderStoryCard(story, index) {
      const isBookmarked = state.bookmarks.includes(story.id);
      return `
        <article class="story-card ${isBookmarked ? 'bookmarked' : ''} animate-in animate-delay-${Math.min(index + 1, 4)}" onclick="openStory('${story.id}')">
          <div class="story-meta">
            <span class="story-section">${story.section}</span>
            <span class="story-date">${formatDate(story.date)}</span>
          </div>
          <h3 class="story-headline">${story.headline}</h3>
          <p class="story-preview">${story.body.split('\n')[0]}</p>
          <div class="story-footer">
            <div class="story-tags">
              ${(story.entities || []).slice(0, 2).map(e => `<span class="tag">${e}</span>`).join('')}
            </div>
            <div class="story-actions">
              <button class="action-btn ${isBookmarked ? 'active' : ''}" onclick="event.stopPropagation(); toggleBookmarkById('${story.id}')" title="Add to Reading List">
                <svg viewBox="0 0 24 24" fill="${isBookmarked ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>
              </button>
            </div>
          </div>
        </article>
      `;
    }

    function renderTopicsView() {
      const topicCounts = {};
      state.stories.forEach(story => {
        (story.topics || []).forEach(topic => {
          topicCounts[topic] = (topicCounts[topic] || 0) + 1;
        });
      });
      
      const sorted = Object.entries(topicCounts).sort((a, b) => b[1] - a[1]);
      
      return `
        <div class="section-header">
          <h2 class="section-title">Browse by Topic</h2>
          <span class="section-count">${sorted.length} topics</span>
        </div>
        <div class="topics-grid">
          ${sorted.map(([topic, count], i) => `
            <div class="topic-card animate-in animate-delay-${Math.min(i + 1, 4)}" onclick="filterByTopic('${topic}')">
              <h3 class="topic-name">${topic}</h3>
              <span class="topic-count">${count} ${count === 1 ? 'story' : 'stories'}</span>
            </div>
          `).join('')}
        </div>
      `;
    }

    function renderBookmarksView() {
      const bookmarked = state.stories.filter(s => state.bookmarks.includes(s.id));
      
      if (bookmarked.length === 0) {
        return `
          <div class="section-header">
            <h2 class="section-title">Reading List</h2>
          </div>
          <div class="empty-state">
            <div class="empty-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>
            </div>
            <h3 class="empty-title">No saved stories yet</h3>
            <p class="empty-text">Bookmark stories to build your reading list. Click the bookmark icon on any story card.</p>
          </div>
        `;
      }
      
      return `
        <div class="section-header">
          <h2 class="section-title">Reading List</h2>
          <span class="section-count">${bookmarked.length} saved</span>
        </div>
        <div class="stories-grid">
          ${bookmarked.map((story, i) => renderStoryCard(story, i)).join('')}
        </div>
      `;
    }

    function renderInsightsView() {
      const topicCounts = {};
      const entityCounts = {};
      
      state.stories.forEach(story => {
        (story.topics || []).forEach(t => topicCounts[t] = (topicCounts[t] || 0) + 1);
        (story.entities || []).forEach(e => entityCounts[e] = (entityCounts[e] || 0) + 1);
      });
      
      const topTopics = Object.entries(topicCounts).sort((a, b) => b[1] - a[1]).slice(0, 5);
      const topEntities = Object.entries(entityCounts).sort((a, b) => b[1] - a[1]).slice(0, 5);
      
      return `
        <div class="section-header">
          <h2 class="section-title">Archive Insights</h2>
        </div>
        <div class="insights-grid">
          <div class="insight-card animate-in animate-delay-1">
            <div class="insight-header">
              <div class="insight-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
              </div>
              <h3 class="insight-title">Total Stories</h3>
            </div>
            <div class="insight-value">${state.stories.length}</div>
            <p class="insight-label">in your archive</p>
          </div>
          
          <div class="insight-card animate-in animate-delay-2">
            <div class="insight-header">
              <div class="insight-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>
              </div>
              <h3 class="insight-title">Saved to Read</h3>
            </div>
            <div class="insight-value">${state.bookmarks.length}</div>
            <p class="insight-label">in your reading list</p>
          </div>
          
          <div class="insight-card animate-in animate-delay-3">
            <div class="insight-header">
              <div class="insight-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
              </div>
              <h3 class="insight-title">Top Topics</h3>
            </div>
            <ul class="insight-list">
              ${topTopics.map(([topic, count]) => `
                <li><span class="topic">${topic}</span><span class="count">${count}</span></li>
              `).join('')}
            </ul>
          </div>
          
          <div class="insight-card animate-in animate-delay-4">
            <div class="insight-header">
              <div class="insight-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
              </div>
              <h3 class="insight-title">Most Mentioned</h3>
            </div>
            <ul class="insight-list">
              ${topEntities.map(([entity, count]) => `
                <li><span class="topic">${entity}</span><span class="count">${count}</span></li>
              `).join('')}
            </ul>
          </div>
        </div>
      `;
    }

    // ========== FILTERING ==========
    function filterStories(stories) {
      if (!state.searchQuery) return stories;
      
      const query = state.searchQuery.toLowerCase();
      return stories.filter(story => {
        return story.headline.toLowerCase().includes(query) ||
               story.body.toLowerCase().includes(query) ||
               (story.topics || []).some(t => t.toLowerCase().includes(query)) ||
               (story.entities || []).some(e => e.toLowerCase().includes(query));
      });
    }

    function filterByTopic(topic) {
      state.searchQuery = topic;
      document.getElementById('search-input').value = topic;
      setView('stories');
    }

    function filterByRecent() {
      // Could implement date filtering here
      showToast('Showing stories from this week');
    }

    // ========== STORY MODAL ==========
    function openStory(id) {
      const story = state.stories.find(s => s.id === id);
      if (!story) return;
      
      state.selectedStory = story;
      
      document.getElementById('modal-section').textContent = story.section;
      document.getElementById('modal-date').textContent = formatDate(story.date);
      document.getElementById('modal-headline').textContent = story.headline;
      document.getElementById('modal-body').innerHTML = story.body.split('\n\n').map(p => `<p>${p}</p>`).join('');
      document.getElementById('modal-tags').innerHTML = [
        ...(story.topics || []),
        ...(story.entities || [])
      ].map(tag => `<span class="tag">${tag}</span>`).join('');
      
      // Load notes
      document.getElementById('modal-notes').value = state.notes[id] || '';
      
      // Update bookmark button
      updateBookmarkButton();
      
      document.getElementById('story-modal').classList.add('open');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      // Save notes before closing
      if (state.selectedStory) {
        const notes = document.getElementById('modal-notes').value.trim();
        if (notes) {
          state.notes[state.selectedStory.id] = notes;
        } else {
          delete state.notes[state.selectedStory.id];
        }
        saveState();
      }
      
      state.selectedStory = null;
      document.getElementById('story-modal').classList.remove('open');
      document.body.style.overflow = '';
    }

    // ========== BOOKMARKS ==========
    function toggleBookmark() {
      if (!state.selectedStory) return;
      toggleBookmarkById(state.selectedStory.id);
      updateBookmarkButton();
    }

    function toggleBookmarkById(id) {
      const index = state.bookmarks.indexOf(id);
      if (index > -1) {
        state.bookmarks.splice(index, 1);
        showToast('Removed from Reading List');
      } else {
        state.bookmarks.push(id);
        showToast('Added to Reading List');
      }
      saveState();
      updateBookmarkCount();
      render();
    }

    function updateBookmarkButton() {
      if (!state.selectedStory) return;
      const isBookmarked = state.bookmarks.includes(state.selectedStory.id);
      const btn = document.getElementById('bookmark-btn');
      const text = document.getElementById('bookmark-text');
      
      btn.classList.toggle('active', isBookmarked);
      text.textContent = isBookmarked ? 'In Reading List' : 'Add to Reading List';
    }

    function updateBookmarkCount() {
      document.getElementById('bookmark-count').textContent = state.bookmarks.length;
    }

    // ========== UTILITIES ==========
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }

    function copyLink() {
      if (!state.selectedStory) return;
      const url = `${window.location.origin}${window.location.pathname}#story-${state.selectedStory.id}`;
      navigator.clipboard.writeText(url).then(() => {
        showToast('Link copied to clipboard');
      });
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toast-message').textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2500);
    }

    function showShortcuts() {
      document.getElementById('shortcuts-modal').classList.add('open');
      document.body.style.overflow = 'hidden';
    }

    function closeShortcuts() {
      document.getElementById('shortcuts-modal').classList.remove('open');
      document.body.style.overflow = '';
    }

    // ========== EVENT LISTENERS ==========
    // Search
    document.getElementById('search-input').addEventListener('input', (e) => {
      state.searchQuery = e.target.value;
      if (state.currentView !== 'stories') {
        setView('stories');
      } else {
        render();
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      // Don't trigger shortcuts when typing in inputs
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
        if (e.key === 'Escape') {
          e.target.blur();
        }
        return;
      }
      
      // Cmd/Ctrl + K for search
      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('search-input').focus();
        return;
      }
      
      // Number keys for navigation
      if (e.key === '1') setView('stories');
      if (e.key === '2') setView('topics');
      if (e.key === '3') setView('bookmarks');
      if (e.key === '4') setView('insights');
      
      // Escape to close modals
      if (e.key === 'Escape') {
        if (document.getElementById('story-modal').classList.contains('open')) {
          closeModal();
        } else if (document.getElementById('shortcuts-modal').classList.contains('open')) {
          closeShortcuts();
        }
      }
      
      // B for bookmark (when story is open)
      if (e.key === 'b' && state.selectedStory) {
        toggleBookmark();
      }
      
      // ? for shortcuts
      if (e.key === '?') {
        showShortcuts();
      }
    });

    // Close modals on overlay click
    document.getElementById('story-modal').addEventListener('click', (e) => {
      if (e.target.id === 'story-modal') closeModal();
    });

    document.getElementById('shortcuts-modal').addEventListener('click', (e) => {
      if (e.target.id === 'shortcuts-modal') closeShortcuts();
    });

    // ========== INIT ==========
    loadState();
    render();
  </script>
</body>
</html>
